@using Microsoft.AspNetCore.Identity
@inject UserManager<LinkifyDAL.Entities.User> UserManager

@{
    var userId = UserManager.GetUserId(User);
    var user = userId != null ? await UserManager.FindByIdAsync(userId) : null;
}


<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ProConnect - The premier professional networking platform for career growth and business connections">
    <meta name="keywords" content="professional networking, career, jobs, connections, business">
    <meta name="author" content="ProConnect">
    <meta name="theme-color" content="#1b84ff">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="ProConnect - Professional Network">
    <meta property="og:description" content="Connect with professionals, discover opportunities, and grow your career">
    <meta property="og:image" content="/images/og-image.jpg">
    <meta property="og:url" content="https://proconnect.com">
    <meta property="og:type" content="website">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ProConnect - Professional Network">
    <meta name="twitter:description" content="Connect with professionals, discover opportunities, and grow your career">
    <meta name="twitter:image" content="/images/twitter-image.jpg">

    <title>Linkify</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">


    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    @RenderSection("Styles", required: false)

    <!-- Stylesheets -->
    <link href="~/css/Home/all.min.css">
    <link href="~/css/Home/style.css" rel="stylesheet">
    <link href="~/css/Home/style2.css" rel="stylesheet">
    <link href="~/css/Nav.css" rel="stylesheet">
    <link rel="preload" href="~/css/Home/style.css" as="style">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" as="style">
    <!-- In the <head> section -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />

</head>
<body>
    <!-- Create Post Modal -->
    <div id="postModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Create a Post</h3>
                <button class="close-button" onclick="closePostModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="createPostForm" onsubmit="handlePostSubmit(event)">
                    <div class="modal-user-info">
                        <div class="create-post-avatar">JD</div>
                        <div>
                            <div style="font-weight: 600; color: var(--text-primary);">John Doe</div>
                            <div style="font-size: 12px; color: var(--text-secondary);"><i class="fas fa-globe-americas"></i> Public</div>
                        </div>
                    </div>

                    <textarea name="TextContent"
                              class="post-textarea"
                              placeholder="What's on your mind, John?"
                              required
                              oninput="updateSubmitButton()"></textarea>

                    <div id="imageUploadSection" class="image-upload-section" onclick="document.getElementById('imageInput').click()">
                        <div class="image-upload-icon">📷</div>
                        <div class="image-upload-text">Add photos to your post</div>
                    </div>

                    <div id="imagePreviewContainer" class="image-preview-container"></div>

                    <input type="file"
                           id="imageInput"
                           name="Images"
                           multiple
                           accept="image/*"
                           class="hidden"
                           onchange="handleImagePreview(event)">

                    <div class="modal-footer">
                        <div class="modal-actions">
                            <button type="button" class="modal-action-btn" onclick="document.getElementById('imageInput').click()" title="Add Photo">
                                <i class="fas fa-image"></i>
                            </button>
                            <button type="button" class="modal-action-btn" title="Tag People">
                                <i class="fas fa-user-tag"></i>
                            </button>
                            <button type="button" class="modal-action-btn" title="Feeling/Activity">
                                <i class="fas fa-smile"></i>
                            </button>
                            <button type="button" class="modal-action-btn" title="Location">
                                <i class="fas fa-map-marker-alt"></i>
                            </button>
                        </div>
                        <button type="submit" id="postSubmitBtn" class="post-submit-btn" disabled>
                            Post
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <partial name="_NavPartial" />
    <div class="main-container" >
        <!-- Left Sidebar -->
        @await Html.PartialAsync("_LeftSidebarPartial", user)

        <!-- Main Feed -->
        <main class="main-feed" id="main-content" role="main" aria-label="Main content">
            <!-- Create Post Section -->
            <div class="create-post" id="create-post">
                <div class="create-post-header">
                    <img src="/api/placeholder/50/50" alt="Your profile" class="create-post-avatar">
                    <button id="openModalTrigger" class="post-trigger-button">
                        <i class="fas fa-pen"></i> Start a post
                    </button>

                </div>
            </div>
            @await Html.PartialAsync("_CreatePostModal", new PostCreateMV())
            @RenderBody()
        </main>

        <!-- Right Sidebar -->
        <aside class="right-sidebar">
            <div class="widget">
                <h3 class="widget-title">
                    <i class="fas fa-user-plus"></i>
                <a href="/Home/PeopleYouMayKnow" style="color: inherit; text-decoration: none;">
                    People You May Know
                </a>
                </h3>
                <div class="suggestion-item">
                    <div class="suggestion-avatar">AL</div>
                    <div style="flex: 1">
                        <h4 style="font-size: 14px; margin-bottom: 2px">
                            Alice Lee
                        </h4>
                        <p style="font-size: 12px; color: var(--dark-gray)">
                            Data Scientist
                        </p>
                    </div>
                    <button class="connect-btn">Connect</button>
                </div>
                <div class="suggestion-item">
                    <div class="suggestion-avatar">RB</div>
                    <div style="flex: 1">
                        <h4 style="font-size: 14px; margin-bottom: 2px">
                            Robert Brown
                        </h4>
                        <p style="font-size: 12px; color: var(--dark-gray)">
                            Marketing Manager
                        </p>
                    </div>
                    <button class="connect-btn">Connect</button>
                </div>
                <div class="suggestion-item">
                    <div class="suggestion-avatar">EW</div>
                    <div style="flex: 1">
                        <h4 style="font-size: 14px; margin-bottom: 2px">
                            Emma Wilson
                        </h4>
                        <p style="font-size: 12px; color: var(--dark-gray)">
                            Frontend Developer
                        </p>
                    </div>
                    <button class="connect-btn">Connect</button>
                </div>
            </div>

            <div class="widget">
                <h3 class="widget-title">
                    <i class="fas fa-briefcase"></i>
                    Job Recommendations
                </h3>
                <div style="margin-bottom: 15px">
                    <h4
                        style="
                            font-size: 14px;
                            color: var(--primary-blue);
                            margin-bottom: 5px;
                    "
                    >
                        Senior Developer
                    </h4>
                    <p
                        style="
                            font-size: 12px;
                            color: var(--dark-gray);
                            margin-bottom: 5px;
                    "
                    >
                        TechCorp Inc.
                    </p>
                    <p style="font-size: 12px; color: var(--dark-gray)">
                        Remote • $80k-$120k
                    </p>
                </div>
                <div style="margin-bottom: 15px">
                    <h4
                        style="
                            font-size: 14px;
                            color: var(--primary-blue);
                            margin-bottom: 5px;
                    "
                    >
                        UX Designer
                    </h4>
                    <p
                        style="
                            font-size: 12px;
                            color: var(--dark-gray);
                            margin-bottom: 5px;
                    "
                    >
                        DesignStudio
                    </p>
                    <p style="font-size: 12px; color: var(--dark-gray)">
                        New York • $70k-$95k
                    </p>
                </div>
            </div>
        </aside>
    </div>
    


    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js" crossorigin="anonymous"></script>
    <script src="~/js/Home/script.js"></script>
    <script src="~/js/Home/script2.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Handle the dropdown theme mode selections
            const themeElements = document.querySelectorAll('[data-kt-element="mode"]');

            // Load saved theme
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);

            // Add click handlers to theme selection items
            themeElements.forEach(element => {
                element.addEventListener('click', function(e) {
                    e.preventDefault();
                    const newTheme = this.getAttribute('data-kt-value');

                    if (newTheme && (newTheme === 'light' || newTheme === 'dark')) {
                        document.documentElement.setAttribute('data-theme', newTheme);
                        localStorage.setItem('theme', newTheme);

                        console.log(`Theme switched to: ${newTheme}`); // Debug log
                    }
                });
            });

            // Also handle click on the main theme toggle button
            const mainToggle = document.querySelector('[data-kt-menu-trigger]');
            if (mainToggle) {
                // Just for debugging - log when clicked
                mainToggle.addEventListener('click', function() {
                    console.log('Theme toggle clicked');
                });
            }
        });

        const postInput = document.querySelector('.post-input');
        const createPost = document.querySelector('.create-post');
        const actions = document.querySelector('.create-post-actions');

        postInput.addEventListener('focus', function() {
            createPost.classList.add('expanded');
            actions.style.display = 'block';
        });
        postInput.addEventListener('blur', function() {
            if (!this.value.trim()) {
                createPost.classList.remove('expanded');
                actions.style.display = 'none';
            }
        });

    </script>
    @RenderSection("Scripts", required: false)
    <!-- Before </body> -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


</body>
</html>

